<section class="container-secret-manager-form">
  <div class="card">
    <div class="card-body">
      <h5 class="card-title">
        <div class="d-flex bd-highlight">
          <div class="w-100 bd-highlight">
            Config Tool <span>| Vulnerability Manager</span>
          </div>
          <div class="flex-shrink-1 bd-highlight">
            <app-tooltip
              tooltipTitle="Configuration of Vulnerability Manager (Defect Dojo)"
              fontSize="1rem"
            ></app-tooltip>
          </div>
        </div>
      </h5>
      <form [formGroup]="parentForm" class="row g-3">
        <div class="col-12">
          <div class="mb-3">
            <label for="branchFilter" class="form-label"
              >Branch Filter:
              <app-tooltip
                tooltipTitle="Field to define the branches emitting reports to the vulnerability manager"
              ></app-tooltip>
            </label>
            <div class="input-group has-validation">
              <input
                formControlName="BRANCH_FILTER"
                type="text"
                class="form-control"
                [ngClass]="parentForm | inputValidation : 'BRANCH_FILTER'"
                [readonly]="false"
                id="branchFilter"
              />
              <div class="invalid-tooltip">The Branch Filter is not valid.</div>
            </div>
          </div>
          <div formGroupName="DEFECT_DOJO">
            <div class="mb-3">
              <label for="CMDBMappingPath" class="form-label"
                >CMDB Mapping Path:
                <app-tooltip
                  tooltipTitle="Field to define the path of the cmdb_mapping.json"
                ></app-tooltip>
              </label>
              <div class="input-group has-validation">
                <input
                  formControlName="CMDB_MAPPING_PATH"
                  type="text"
                  class="form-control"
                  [ngClass]="
                    getDefectDojoFormGroup()
                      | inputValidation : 'CMDB_MAPPING_PATH'
                  "
                  [readonly]="false"
                  id="CMDBMappingPath"
                />
                <div class="invalid-tooltip">
                  The CMDB Mapping Path is not valid.
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="hostCMDB" class="form-label"
                >Host CMDB:
                <app-tooltip
                  tooltipTitle="Field to define the host of the cmdb_mapping.json"
                ></app-tooltip>
              </label>
              <div class="input-group has-validation">
                <input
                  formControlName="HOST_CMDB"
                  type="text"
                  class="form-control"
                  [ngClass]="
                    getDefectDojoFormGroup() | inputValidation : 'HOST_CMDB'
                  "
                  [readonly]="false"
                  id="hostCMDB"
                />
                <div class="invalid-tooltip">The Host CMDB is not valid.</div>
              </div>
            </div>
            <div class="mb-3">
              <label for="hostDefectDojo" class="form-label"
                >Host Defect Dojo:
                <app-tooltip
                  tooltipTitle="Field to define the host of the vulnerability manager (Defect Dojo)"
                ></app-tooltip>
              </label>
              <div class="input-group has-validation">
                <input
                  formControlName="HOST_DEFECT_DOJO"
                  type="text"
                  class="form-control"
                  [ngClass]="
                    getDefectDojoFormGroup()
                      | inputValidation : 'HOST_DEFECT_DOJO'
                  "
                  [readonly]="false"
                  id="hostDefectDojo"
                />
                <div class="invalid-tooltip">
                  The Host Defect Dojo is not valid.
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="regexExpressionCMDB" class="form-label"
                >Regex Expression CMDB:
                <app-tooltip
                  tooltipTitle="Field to define the regular expression that extracts the mapped keys in the CMDB"
                ></app-tooltip>
              </label>
              <div class="input-group has-validation">
                <input
                  formControlName="REGEX_EXPRESSION_CMDB"
                  type="text"
                  class="form-control"
                  [ngClass]="
                    getDefectDojoFormGroup()
                      | inputValidation : 'REGEX_EXPRESSION_CMDB'
                  "
                  [readonly]="false"
                  id="regexExpressionCMDB"
                />
                <div class="invalid-tooltip">
                  The Regex Expression CMDB is not valid.
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="limitsQuery" class="form-label"
                >Limits Query:
                <app-tooltip
                  tooltipTitle="Field to define the maximum number of records that the query brings from Defect Dojo (999 recommended amount)"
                ></app-tooltip>
              </label>
              <div class="input-group has-validation">
                <input
                  formControlName="LIMITS_QUERY"
                  type="number"
                  class="form-control"
                  [ngClass]="
                    getDefectDojoFormGroup() | inputValidation : 'LIMITS_QUERY'
                  "
                  [readonly]="false"
                  id="limitsQuery"
                />
                <div class="invalid-tooltip">
                  The Limits Query is not valid.
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>
