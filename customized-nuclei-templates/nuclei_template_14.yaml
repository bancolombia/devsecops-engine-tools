id: xss-deprecated-header

info:
  name: XSS-Protection Header - Cross-Site Scripting
  author: devsecops
  severity: low
  description: Setting the XSS-Protection header is deprecated. Setting the header
    to anything other than `0` can actually introduce an XSS vulnerability.
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection
  - https://owasp.org/www-project-secure-headers/#x-xss-protection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C
    cvss-score: 4.0
  metadata:
    max-request: 1
  tags: api,wa,http

http:
- method: GET
  path:
  - '{{BaseURL}}/fact'
  matchers-condition: and
  matchers:
  - type: regex
    part: header
    regex:
    - '(?i)x-xss-protection: 0'
    negative: true

  - type: regex
    part: header
    regex:
    - '(?i)x-xss-protection: 1+'

  extractors:
  - type: kval
    part: header
    kval:
    - x_xss_protection
  headers:
    accept: application/json
