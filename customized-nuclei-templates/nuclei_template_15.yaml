id: http-content-type-header

info:
  name: HTTP Missing Security Headers
  author: devsecops
  severity: low
  classification:
    cvss-score: 2.0
  description: |
    This template searches for missing  Content-Type header.
  metadata:
    max-request: 1
  tags: api,wa,http

http:
- method: GET
  path:
  - '{{BaseURL}}/fact'
  host-redirects: true
  max-redirects: 3

  matchers-condition: or
  matchers:

  - type: dsl
    name: content-type
    dsl:
    - "!regex('(?i)content-type', header)"
    - status_code != 301 && status_code != 302
    condition: and
  headers:
    accept: application/json
