id: expired-ssl

info:
  name: Expired SSL Certificate
  author: devsecops
  severity: low
  classification:
    cvss-score: 2.0
  description: |
    After an SSL certificate expires, you will no longer be able to communicate over a secure, encrypted HTTPS connection.
  remediation: |
    Purchase or generate a new SSL/TLS certificate to replace the existing one.
  reference:
  - https://www.acunetix.com/vulnerabilities/web/tls-ssl-certificate-about-to-expire/
  metadata:
    max-request: 1
  tags: api,wa,ssl
ssl:
- address: '{{Host}}:{{Port}}'
  matchers:
  - type: dsl
    dsl:
    - expired == true

  extractors:
  - type: kval
    kval:
    - not_after
