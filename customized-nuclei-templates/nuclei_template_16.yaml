id: x-frame-options-header

info:
  name: X Frame Options Header
  author: devsecops
  severity: low
  description: |
    The application uses the X-Frame Options header as the only protection measure against clickjacking attacks. This header is considered obsolete, because its protection can be bypassed using multiple-layer iframes.
  metadata:
    max-request: 1
  tags: api,wa,http
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N/E:H/RL:O/RC:C
    cvss-score: 3.0
http:
- method: GET
  path:
  - '{{BaseURL}}/fact'
  host-redirects: true
  max-redirects: 3

  matchers-condition: or
  matchers:
  - type: dsl
    name: x-frame-options
    dsl:
    - "!regex('(?i)x-frame-options: DENY', header)"
    - status_code != 301 && status_code != 302
    condition: and
  headers:
    accept: application/json
