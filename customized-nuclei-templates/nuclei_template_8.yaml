id: check-fields-certificate

info:
  name: Check fields TLS certificate
  author: devsecops
  severity: low
  classification:
    cvss-score: 2.0
  description: |
    Validates that the certificate contains all the required values.
  metadata:
    verified: 'true'
    max-request: 1
  tags: api,wa,ssl
ssl:
- address: '{{Host}}:{{Port}}'
  matchers:
  - type: word
    part: subject_dn
    words:
    - ST=ANTIOQUIA
    - L=MEDELLIN
    - C=CO
    - OU=VICEPRESIDENCIA DE TECNOLOGIA
    - O=BANCOLOMBIA S.A.
    condition: and
    negative: true

  extractors:
  - type: json
    json:
    - .subject_dn
